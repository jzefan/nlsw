{"version":3,"sources":["vehves_cost_mgt.js"],"names":["$","opts","dbData","vehvesNameSelect","rVehicle","rVessel","vehicleTable","vesselTable","dataBtnOk","searchBtnOk","startDateGrp","endDateGrp","yearGrp","monthGrp","sVVName","monthChoiceGrp","monthChoice","iIC","iHC","iPCC","iAux","iFittings","iRepair","iAS","iSalary","iOil","iToll","iFine","iOther","iTotal","allInputFields","find","btnUpdate","btnRemove","btnExport","isVehicle","startDate","endDate","selectedMonth","selectedVehVes","tHandler","TableHandler","createNew","switchVehicleVessel","isVeh","showHtmlElement","setVehileFlag","show","enableButton","getAndShowVFCData","fVVName","fDate1","fDate2","fVVType","dateChanged","e","id","target","attr","date","startOf","moment","add","setHtmlElementDisabled","data","setMinDate","isBefore","setMaxDate","format","okEnabled","isEmpty","val","getOneData","switchDateChoose","isYear","isNonYear","isMonth","qObj","css","cursor","get","result","jQuery","parseJSON","ok","setVVData","vvcList","field","name","fName","fMonth","bootbox","alert","select2","local_data","initSelect","vehicles","vehList","iCheck","getDateTimePickerOptions","minViewMode","datetimepicker","on","each","this","value","ForceNumericOnly","modal","backdrop","keyboard","toISOString","elementEventRegister","obj","data_action","idx","dis","num","isNumeric","parseFloat","ic","hc","pcc","aux","fittings","repair","annual_survey","salary","oil","toll","fine","other","total","month","vv_type","ajaxRequestHandle","addData","indexOf","push","append","updateData","getSelectedData","removeData","isExistSameName","opt","remove","length","exportExcel","selectedIdx","tableHandler","vehTable","vesTable","vehicleBody","vesselBody","vvData","enableButtonFunc","self","vvBody","empty","str","v2","v3","v4","v5","v6","v7","v8","v9","v10","forEach","vv","getStrValue","lv1","lv2","lv3","lv4","lv5","lv6","tr_click","index","numOfTrs","inData","found","i","unshift","exist","type","inFlag","t","tableToExcel","html"],"mappings":"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","file":"vehves_cost_mgt.js","sourcesContent":["/**\r\n * Created by ezefjia on 2015/5/10.\r\n */\r\n\r\n$(function () {\r\n  \"use strict\";\r\n\r\n  var dbData = {};\r\n\r\n  var vehvesNameSelect = $('#vehves-name');\r\n  var rVehicle     = $('#radio-vehicle');\r\n  var rVessel      = $('#radio-vessel');\r\n  var vehicleTable = $('#vehicle-table');\r\n  var vesselTable  = $('#vessel-table');\r\n\r\n  var dataBtnOk    = $('#data-btn-ok');\r\n  var searchBtnOk  = $('#stat-btn-ok');\r\n  var startDateGrp = $('#start-date-grp');\r\n  var endDateGrp   = $('#end-date-grp');\r\n  var yearGrp      = $('#year-grp');\r\n  var monthGrp     = $('#month-grp');\r\n\r\n  var sVVName = $('#vvname');\r\n  var monthChoiceGrp = $('#month-choice-grp');\r\n  var monthChoice = $('#month-choice');\r\n\r\n  var iIC  = $('#i-ic');\r\n  var iHC  = $('#i-hc');\r\n  var iPCC = $('#i-pcc');\r\n  var iAux = $('#i-aux');\r\n  var iFittings = $('#i-fittings');\r\n  var iRepair   = $('#i-repair');\r\n  var iAS       = $('#i-as');\r\n  var iSalary   = $('#i-salary');\r\n  var iOil      = $('#i-oil');\r\n  var iToll     = $('#i-toll');\r\n  var iFine     = $('#i-fine');\r\n  var iOther    = $('#i-other');\r\n  var iTotal = $('#i-total');\r\n  var allInputFields = $('#data-input').find('input');\r\n\r\n  var btnUpdate = $('#data-modify');\r\n  var btnRemove = $('#data-delete');\r\n  var btnExport = $('#data-export');\r\n\r\n  var isVehicle = true;\r\n  var startDate = null, endDate = null;\r\n  var selectedMonth = '';\r\n  var selectedVehVes = [];\r\n  var tHandler = TableHandler.createNew(true);\r\n\r\n  if (local_data) {\r\n    dbData = local_data;\r\n    initSelect(vehvesNameSelect, dbData.vehicles, false);\r\n    initSelect(sVVName, dbData.vehList, false);\r\n  }\r\n\r\n  rVehicle.iCheck('check');\r\n  rVessel.iCheck('uncheck');\r\n\r\n  vehvesNameSelect.select2();\r\n  sVVName.select2();\r\n\r\n  dateComponentInitial();\r\n\r\n  allInputFields.each(function() {\r\n    this.value = '';\r\n    $(this).ForceNumericOnly();\r\n  });\r\n\r\n  setHtmlElementDisabled(iTotal, true);\r\n\r\n  function switchVehicleVessel(isVeh) {\r\n    isVehicle = isVeh;\r\n\r\n    showHtmlElement(vehicleTable, isVeh);\r\n    showHtmlElement(vesselTable, !isVeh);\r\n    showHtmlElement($('#vehicle-row'), isVeh);\r\n    showHtmlElement($('#vessel-row'), !isVeh);\r\n    showHtmlElement($('#dd-col-vvname'), isVeh);\r\n    showHtmlElement($('#s2id_vehves-name'), isVeh);\r\n    showHtmlElement($('#lb-vehves-name'), isVeh);\r\n\r\n    tHandler.setVehileFlag(isVeh);\r\n    tHandler.show(enableButton);\r\n\r\n    if (!isVeh) {\r\n      getAndShowVFCData({ fVVName: ['chuan'], fDate1: null, fDate2: null, fVVType: 'chuan'});\r\n    }\r\n  }\r\n\r\n  rVehicle.on('ifChecked', function() { switchVehicleVessel(true); });\r\n  rVessel.on('ifChecked', function() { switchVehicleVessel(false); });\r\n\r\n  // 月份选择处理\r\n  $('#month-search').on('click', function() {\r\n    startDate = null;\r\n    endDate = null;\r\n    $('.input-group.date').find('input').each(function() {\r\n      this.value = '';\r\n    });\r\n\r\n    setHtmlElementDisabled(searchBtnOk, true);\r\n    $('#radio_month').iCheck('check');\r\n    $('#stat-condition-dialog').modal({ backdrop: 'static', keyboard: false}).modal('show');\r\n  });\r\n\r\n  function dateChanged(e) {\r\n    var me = $(e.target);\r\n    var id = me.attr('id');\r\n    if (id === \"month-grp\") {\r\n      startDate = e.date.startOf('month');\r\n      endDate = moment(startDate).add(1, 'months');\r\n      setHtmlElementDisabled(searchBtnOk, false);\r\n    }\r\n    else if (id === \"start-date-grp\") {\r\n      endDateGrp.data(\"DateTimePicker\").setMinDate(e.date);\r\n      startDate = e.date.startOf('month');\r\n      if (startDate && endDate && startDate.isBefore(endDate)) {\r\n        setHtmlElementDisabled(searchBtnOk, false);\r\n      }\r\n    }\r\n    else if (id === \"end-date-grp\") {\r\n      startDateGrp.data(\"DateTimePicker\").setMaxDate(e.date);\r\n      endDate = e.date.startOf('month').add(1, 'months');\r\n      if (startDate && endDate && startDate.isBefore(endDate)) {\r\n        setHtmlElementDisabled(searchBtnOk, false);\r\n      }\r\n    }\r\n    else if (id === 'month-choice-grp') {\r\n      selectedMonth = e.date.startOf('month').format(\"YYYY-MM\");\r\n      var okEnabled = isVehicle ? (!isEmpty(selectedMonth) && iTotal.val() > 0 && sVVName.val()) : (!isEmpty(selectedMonth) && iTotal.val() > 0);\r\n      setHtmlElementDisabled(dataBtnOk, !okEnabled);\r\n      getOneData('month');\r\n    }\r\n    else {\r\n      startDate = e.date.startOf('year');\r\n      endDate = moment(startDate).add(1, 'years');\r\n      setHtmlElementDisabled(searchBtnOk, false);\r\n    }\r\n  }\r\n\r\n  function dateComponentInitial() {\r\n    var opts = getDateTimePickerOptions();\r\n\r\n    opts.minViewMode = 'months';\r\n    opts.format = 'YYYY-MM';\r\n    startDateGrp.datetimepicker(opts).on('dp.change', dateChanged);\r\n    endDateGrp.datetimepicker(opts).on('dp.change', dateChanged);\r\n    monthGrp.datetimepicker(opts).on('dp.change', dateChanged);\r\n\r\n    //monthChoiceGrp.datetimepicker(opts).on('dp.change', dateChanged);\r\n\r\n    opts.minViewMode = 'years';\r\n    opts.format = 'YYYY';\r\n    yearGrp.datetimepicker(opts).on('dp.change', dateChanged);\r\n  }\r\n\r\n  function switchDateChoose(isYear, isNonYear, isMonth) {\r\n    showHtmlElement($('#year-choose'), isYear);\r\n    showHtmlElement($('#non-year-choose'), isNonYear);\r\n    showHtmlElement($('#month-choose'), isMonth);\r\n  }\r\n\r\n  $('#radio_month').on('ifChecked', function() { switchDateChoose(false, true, false); });\r\n  $('#radio_single_year').on('ifChecked', function() { switchDateChoose(true, false, false); });\r\n  $('#radio_single_month').on('ifChecked', function() { switchDateChoose(false, false, true); });\r\n\r\n  function getAndShowVFCData(qObj) {\r\n    $('body').css({'cursor':'wait'});\r\n    $.get('/get_vessel_fixed_cost_data', qObj, function (data) {\r\n      var result = jQuery.parseJSON(data);\r\n      if (result.ok) {\r\n        tHandler.setVVData(result.vvcList);\r\n      } else {\r\n        tHandler.setVVData([]);\r\n      }\r\n\r\n      tHandler.show(enableButton);\r\n      $('body').css({'cursor':'default'});\r\n    });\r\n  }\r\n\r\n  searchBtnOk.on('click', function() {\r\n    $('#stat-condition-dialog').modal('hide');\r\n\r\n    getAndShowVFCData({ fVVName: selectedVehVes,\r\n      fDate1: startDate.toISOString(), fDate2: endDate.toISOString(),\r\n      fVVType: (isVehicle? 'che' : 'chuan') });\r\n  });\r\n\r\n  elementEventRegister(vehvesNameSelect, 'change', function(e) {\r\n    selectedVehVes = e.val;\r\n    var obj = { fVVName: selectedVehVes, fDate1: '', fDate2: '', fVVType: (isVehicle ? 'che' : 'chuan') };\r\n    if (startDate && endDate) {\r\n      obj.fDate1 = startDate.toISOString();\r\n      obj.fDate2 = endDate.toISOString();\r\n    }\r\n\r\n    getAndShowVFCData(obj);\r\n  });\r\n\r\n  ////////////////////////////////////////////////////////////////////////////////////\r\n  function getOneData(field) {\r\n    var name = 'chuan';\r\n    if (isVehicle) {\r\n      name = sVVName.val();\r\n    }\r\n\r\n    var qObj = {\r\n      fName: name ? name : '',\r\n      fMonth: selectedMonth ? selectedMonth : ''\r\n    };\r\n\r\n    $.get('/get_one_vfc_data', qObj, function (data) {\r\n      var result = jQuery.parseJSON(data);\r\n      if (result.ok) {\r\n        bootbox.alert('不能增加, 记录已存在！车船名：' + name + ', 月份:' + selectedMonth);\r\n        if (field === 'name') {\r\n          sVVName.select2().select2('val', '');\r\n        } else if (field === 'month') {\r\n          selectedMonth = '';\r\n          monthChoice.val('');\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  var data_action = '';\r\n  elementEventRegister($('#data-add'), 'click', function() {\r\n    data_action = 'ADD';\r\n    if (isVehicle) {\r\n      sVVName.select2().select2('val', '');\r\n      sVVName.select2('enable');\r\n    }\r\n\r\n    selectedMonth = '';\r\n    monthChoice.val('');\r\n    setHtmlElementDisabled(monthChoice, false);\r\n    setHtmlElementDisabled(monthChoiceGrp, false);\r\n    allInputFields.each(function() { this.value = ''; });\r\n\r\n    var opts = getDateTimePickerOptions();\r\n    opts.minViewMode = 'months';\r\n    opts.format = 'YYYY-MM';\r\n    monthChoiceGrp.datetimepicker(opts).on('dp.change', dateChanged);\r\n    $('#data-dialog').modal({ backdrop: 'static', keyboard: false}).modal('show');\r\n  });\r\n\r\n  elementEventRegister(sVVName, 'change', function(e) {\r\n    var value = e.val;\r\n    var okEnabled = isVehicle ? (!isEmpty(selectedMonth) && iTotal.val() > 0 && value) : (!isEmpty(selectedMonth) && iTotal.val());\r\n    setHtmlElementDisabled(dataBtnOk, !okEnabled);\r\n\r\n    getOneData('name');\r\n  });\r\n\r\n  elementEventRegister(allInputFields, \"keyup paste\", function() {\r\n    var num = 0;\r\n    allInputFields.each(function() {\r\n      var id = $(this).attr('id');\r\n      var val = this.value;\r\n      if (id !== 'i-total' && isNumeric(val)) {\r\n        num += parseFloat(val);\r\n      }\r\n    });\r\n\r\n    iTotal.val(num);\r\n\r\n    var okEnabled = isVehicle ? (!isEmpty(selectedMonth) && num > 0 && sVVName.val()) : (!isEmpty(selectedMonth) && num > 0);\r\n    setHtmlElementDisabled(dataBtnOk, !okEnabled);\r\n  });\r\n\r\n  dataBtnOk.on('click', function() {\r\n    var data = {\r\n      name: (isVehicle ? sVVName.val() : 'chuan'),\r\n      ic: iIC.val() ? parseFloat(iIC.val()) : 0,\r\n      hc: iHC.val() ? parseFloat(iHC.val()) : 0,\r\n      pcc: iPCC.val() ? parseFloat(iPCC.val()) : 0,\r\n      aux: iAux.val() ? parseFloat(iAux.val()) : 0,\r\n      fittings: iFittings.val() ? parseFloat(iFittings.val()) : 0,\r\n      repair: iRepair.val() ? parseFloat(iRepair.val()) : 0,\r\n      annual_survey: iAS.val() ? parseFloat(iAS.val()) : 0,\r\n      salary: iSalary.val() ? parseFloat(iSalary.val()) : 0,\r\n      oil: iOil.val() ? parseFloat(iOil.val()) : 0,\r\n      toll: iToll.val() ? parseFloat(iToll.val()) : 0,\r\n      fine: iFine.val() ? parseFloat(iFine.val()) : 0,\r\n      other: iOther.val() ? parseFloat(iOther.val()) : 0,\r\n      total: iTotal.val(),\r\n      month: selectedMonth,\r\n      vv_type: isVehicle? 'che' : 'chuan'\r\n    };\r\n\r\n    ajaxRequestHandle('/one_vessel_fixed_cost', 'POST', data, '数据保存', function() {\r\n      $('#data-dialog').modal('hide');\r\n      var result = false;\r\n      if (data_action === 'ADD') {\r\n        result = tHandler.addData(data);\r\n        if (result && isVehicle) {\r\n          if (selectedVehVes.indexOf(data.name) < 0) {\r\n            selectedVehVes.push(data.name);\r\n          }\r\n\r\n          if (dbData.vehicles.indexOf(data.name) < 0) {\r\n            vehvesNameSelect.append(\"<option value='\" + data.name + \"'>\" + data.name + \"</option>\");\r\n          }\r\n\r\n          vehvesNameSelect.select2(\"val\", selectedVehVes);\r\n        }\r\n      } else if (data_action === 'UPDATE') {\r\n        result = tHandler.updateData(data);\r\n      }\r\n\r\n      if (result) {\r\n        tHandler.show(enableButton);\r\n      }\r\n    });\r\n  });\r\n\r\n  elementEventRegister(btnUpdate, 'click', function() {\r\n    data_action = 'UPDATE';\r\n    var data = tHandler.getSelectedData();\r\n    if (data) {\r\n      selectedMonth = data.month;\r\n      monthChoice.val(data.month);\r\n      setHtmlElementDisabled(monthChoice, true);\r\n\r\n      if (isVehicle) {\r\n        sVVName.select2().select2('val', data.name);\r\n        sVVName.select2('disable');\r\n\r\n        iFittings.val(data.fittings);\r\n        iRepair.val(data.repair);\r\n        iAS.val(data.annual_survey);\r\n        iSalary.val(data.salary);\r\n        iOil.val(data.oil);\r\n        iToll.val(data.toll);\r\n        iFine.val(data.fine);\r\n      } else {\r\n        iIC.val(data.ic);\r\n        iHC.val(data.hc);\r\n        iPCC.val(data.pcc);\r\n        iAux.val(data.aux);\r\n      }\r\n\r\n      iOther.val(data.other);\r\n      iTotal.val(data.total);\r\n\r\n      var opts = getDateTimePickerOptions();\r\n      opts.minViewMode = 'months';\r\n      opts.format = 'YYYY-MM';\r\n      monthChoiceGrp.datetimepicker(opts).on('dp.change', dateChanged);\r\n      $('#data-dialog').modal({ backdrop: 'static', keyboard: false}).modal('show');\r\n    } else {\r\n      bootbox.alert('请先选择一行');\r\n    }\r\n  });\r\n\r\n  elementEventRegister(btnRemove, 'click', function() {\r\n    var data = tHandler.getSelectedData();\r\n    if (data) {\r\n      ajaxRequestHandle('/delete_vfc_data', 'POST', data, '数据删除', function() {\r\n        if (tHandler.removeData(data.name, data.month)) {\r\n          tHandler.show(enableButton);\r\n\r\n          if (isVehicle && !tHandler.isExistSameName(data.name)) { // 当前显示的数据并不再有name, remove it\r\n            var opt = \"option[value='\" + data.name + \"']\";\r\n            vehvesNameSelect.find(opt).remove();\r\n\r\n            var idx = selectedVehVes.indexOf(data.name);\r\n            if (idx >= 0) {\r\n              selectedVehVes.remove(idx);\r\n              if (selectedVehVes.length) {\r\n                vehvesNameSelect.select2(\"val\", selectedVehVes);\r\n              } else {\r\n                vehvesNameSelect.select2(\"val\", '');\r\n              }\r\n            }\r\n          }\r\n        }\r\n      });\r\n    } else {\r\n      bootbox.alert('请先选择一行');\r\n    }\r\n  });\r\n\r\n  function enableButton(idx) {\r\n    var dis = idx < 0;\r\n    setHtmlElementDisabled(btnUpdate, dis);\r\n    setHtmlElementDisabled(btnRemove, dis);\r\n  }\r\n\r\n  elementEventRegister(btnExport, 'click', function() { tHandler.exportExcel(); });\r\n});\r\n\r\n///////////////////////////////////////////////////////////////////////////////\r\n///////////////////////////////////////////////////////////////////////////////\r\nvar TableHandler = {\r\n  createNew: function(isVehicle) {\r\n    var selectedIdx = -1;\r\n    var tableHandler = {\r\n      vehTable: $('#vehicle-table'),\r\n      vesTable : $('#vessel-table'),\r\n      vehicleBody: $('#vehicle-tbody'),\r\n      vesselBody : $('#vessel-tbody'),\r\n      isVehicle  : isVehicle,\r\n      vvData: []\r\n    };\r\n\r\n    tableHandler.show = function(enableButtonFunc) {\r\n      selectedIdx = -1;\r\n      var self = this;\r\n      var vvBody = self.isVehicle ? self.vehicleBody : self.vesselBody;\r\n      vvBody.empty();\r\n\r\n      if (self.vvData.length) {\r\n        var str = '';\r\n        if (self.isVehicle) {\r\n          var v0 = 0, v1 = 0, v2 = 0, v3 = 0, v4 = 0, v5 = 0, v6 = 0, v7 = 0, v8 = 0, v9 = 0, v10 = 0;\r\n          str = '<tr><td>{0}</td><td>{1}</td><td>{2}</td><td>{3}</td><td>{4}</td><td>{5}</td><td>{6}</td><td>{7}</td><td>{8}</td><td>{9}</td><td>{10}</td></tr>';\r\n          self.vvData.forEach(function(vv) {\r\n            if (vv.vv_type === 'che') {\r\n              vvBody.append(str.format(vv.month, vv.name, getStrValue(vv.fittings), getStrValue(vv.repair),\r\n                getStrValue(vv.annual_survey), getStrValue(vv.salary), getStrValue(vv.oil),\r\n                getStrValue(vv.toll), getStrValue(vv.fine), getStrValue(vv.other), getStrValue(vv.total)));\r\n              v2 += vv.fittings;\r\n              v3 += vv.repair;\r\n              v4 += vv.annual_survey;\r\n              v5 += vv.salary;\r\n              v6 += vv.oil;\r\n              v7 += vv.toll;\r\n              v8 += vv.fine;\r\n              v9 += vv.other;\r\n              v10 += vv.total;\r\n            }\r\n          });\r\n          vvBody.append(str.format('合计', '', getStrValue(v2), getStrValue(v3), getStrValue(v4),\r\n            getStrValue(v5), getStrValue(v6), getStrValue(v7), getStrValue(v8), getStrValue(v9), getStrValue(v10)));\r\n\r\n        } else {\r\n          str = '<tr><td>{0}</td><td>{1}</td><td>{2}</td><td>{3}</td><td>{4}</td><td>{5}</td><td>{6}</td></tr>';\r\n          var lv0 = 0, lv1 = 0, lv2 = 0, lv3 = 0, lv4 = 0, lv5 = 0, lv6 = 0;\r\n          self.vvData.forEach(function(vv) {\r\n            if (vv.vv_type === 'chuan') {\r\n              vvBody.append(str.format(vv.month, getStrValue(vv.ic), getStrValue(vv.hc), getStrValue(vv.pcc),\r\n                getStrValue(vv.aux), getStrValue(vv.other), getStrValue(vv.total)));\r\n              lv1 += vv.ic;\r\n              lv2 += vv.hc;\r\n              lv3 += vv.pcc;\r\n              lv4 += vv.aux;\r\n              lv5 += vv.other;\r\n              lv6 += vv.total;\r\n            }\r\n          });\r\n\r\n          vvBody.append(str.format('合计', getStrValue(lv1), getStrValue(lv2), getStrValue(lv3),\r\n            getStrValue(lv4), getStrValue(lv5), getStrValue(lv6)));\r\n        }\r\n\r\n        tr_click(vvBody.find('tr'), function(e, index) {\r\n          var numOfTrs = vvBody.find('tr').length;\r\n          if (index !== numOfTrs - 1) {\r\n            selectedIdx = index;\r\n            enableButtonFunc(index);\r\n          } else {\r\n            selectedIdx = -1;\r\n            enableButtonFunc(selectedIdx);\r\n          }\r\n        });\r\n      } else {\r\n        selectedIdx = -1;\r\n        enableButtonFunc(selectedIdx);\r\n      }\r\n    };\r\n\r\n    tableHandler.setVVData = function(inData) {\r\n      this.vvData = inData;\r\n    };\r\n\r\n    tableHandler.addData = function(data) {\r\n      var self = this;\r\n      var found = false;\r\n      for (var i = 0; i < self.vvData.length; ++i) {\r\n        if (self.vvData[i].name === data.name && self.vvData[i].month === data.month) {\r\n          found = true;\r\n          break;\r\n        }\r\n      }\r\n\r\n      if (found) {\r\n        bootbox.alert('已存在相同的记录: 车船名 = ' + data.name + ' 月份 = ' + data.month);\r\n      } else {\r\n        self.vvData.unshift(data);\r\n      }\r\n\r\n      return !found;\r\n    };\r\n\r\n    tableHandler.removeData = function(name, month) {\r\n      var self = this;\r\n      var found = false;\r\n      for (var i = 0; i < self.vvData.length; ++i) {\r\n        if (self.vvData[i].name === name && self.vvData[i].month === month) {\r\n          self.vvData.remove(i);\r\n          found = true;\r\n          break;\r\n        }\r\n      }\r\n\r\n      return found;\r\n    };\r\n\r\n    tableHandler.updateData = function(data) {\r\n      var self = this;\r\n      var found = false;\r\n      for (var i = 0; i < self.vvData.length; ++i) {\r\n        if (self.vvData[i].name === data.name && self.vvData[i].month === data.month) {\r\n          self.vvData[i].ic = data.ic;\r\n          self.vvData[i].hc = data.hc;\r\n          self.vvData[i].pcc = data.pcc;\r\n          self.vvData[i].aux = data.aux;\r\n          self.vvData[i].fittings = data.fittings;\r\n          self.vvData[i].repair = data.repair;\r\n          self.vvData[i].annual_survey = data.annual_survey;\r\n          self.vvData[i].salary = data.salary;\r\n          self.vvData[i].oil = data.oil;\r\n          self.vvData[i].toll = data.toll;\r\n          self.vvData[i].fine = data.fine;\r\n          self.vvData[i].other = data.other;\r\n          self.vvData[i].total = data.total;\r\n          found = true;\r\n          break;\r\n        }\r\n      }\r\n\r\n      return found;\r\n    };\r\n\r\n    tableHandler.getSelectedData = function() {\r\n      return this.vvData[selectedIdx];\r\n    };\r\n\r\n    tableHandler.isExistSameName = function(name) {\r\n      var exist = false;\r\n      if (this.vvData.length) {\r\n        var type = this.isVehicle ? 'che' : 'chuan';\r\n        for (var i = 0; i < this.vvData.length; ++i) {\r\n          var vv = this.vvData[i];\r\n          if (vv.vv_type === type && vv.name === name) {\r\n            exist = true;\r\n            break;\r\n          }\r\n        }\r\n      }\r\n\r\n      return exist;\r\n    };\r\n\r\n    tableHandler.setVehileFlag = function(inFlag) {\r\n      this.isVehicle = inFlag;\r\n    };\r\n\r\n    tableHandler.exportExcel = function() {\r\n      var exist = false;\r\n      if (this.vvData.length) {\r\n        var type = this.isVehicle ? 'che' : 'chuan';\r\n        for (var i = 0; i < this.vvData.length; ++i) {\r\n          if (this.vvData[i].vv_type === type) {\r\n            exist = true;\r\n            break;\r\n          }\r\n        }\r\n      }\r\n\r\n      if (exist) {\r\n        var t = (this.isVehicle ? this.vehTable : this.vesTable);\r\n        tableToExcel(t.html(), \"data\");\r\n      }\r\n    };\r\n\r\n    return tableHandler;\r\n  }\r\n};"]}