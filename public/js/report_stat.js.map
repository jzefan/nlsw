{"version":3,"sources":["report_stat.js"],"names":["$","chart","startDate","endDate","ldata","opts","titleEN2CN","settledWDS","notSettledWDS","notNeedWDS","settledWZT","notSettledWZT","notNeedWZT","totalWeight","totalPrice","tableBody","startDateGrp","endDateGrp","yearGrp","monthGrp","dbData","chartData","allNames","btnOk","ckShowDiagram","action","local_action","chartWeight","detailTBody","billNameFilter","FilterElementD","sort_pinyin","local_data","forEach","ld","month","drayage","forklift","dateChanged","e","id","target","attr","date","startOf","moment","add","setHtmlElementDisabled","data","setMinDate","isBefore","setMaxDate","getMonthList","numOfMonth","diff","monthList","i","push","format","showCustomerData","isZeroToSpace","len","length","empty","item","s","wds1","wds2","wds3","wzt1","wzt2","wzt3","total","tprice","pds1","pds2","pzt1","pzt2","settledPDS","notSettledPDS","settledPZT","notSettledPZT","append","name","getStrValue","showCustomerChart","balloonText","graphs","legend","position","valueText","valueWidth","valueAlign","equalWidths","periodValueText","type","title","valueField","lineAlpha","fillAlphas","AmCharts","makeChart","dataProvider","marginTop","categoryField","categoryAxis","gridAlpha","axisColor","minorGridEnabled","guides","lineColor","inside","value","toValue","fillColor","fillAlpha","valueAxes","stackType","chartCursor","key","hasOwnProperty","lineThickness","bullet","rotate","gridPosition","creditsPosition","vesselChart","clear","vv","车总吨位","vhTotal","自有车吨位","vhOwnWeight","外挂车吨位","vhNonOwnWeight","船总吨位","vsTotal","自有船吨位","vsOwnWeight","外挂船吨位","vsNonOwnWeight","车总金额","vhRevenue","自有车收金额","vhOwnIncome","外挂车收金额","vhNonOwnIncome","外挂车付金额","vhNonOwnDeposit","船总金额","vsRevenue","自有船收金额","vsOwnIncome","外挂船收金额","vsNonOwnIncome","外挂船付金额","vsNonOwnDeposit","AmSerialChart","valueAxis","ValueAxis","dashLength","axisAlpha","addValueAxis","graph","AmGraph","addGraph","ChartCursor","cursorAlpha","zoomable","categoryBalloonEnabled","addChartCursor","write","showVesselDetail","isSummary","vehType","css","cursor","obj","fDate1","toISOString","fDate2","fVehType","text","fSummary","get","result","jQuery","parseJSON","ok","one","summary_data","weight","amount","contact","modal","backdrop","keyboard","bootbox","alert","vObj","vessel_detail","nameList","vehNameList","vesselDetailBody","t","ship_from","ship_to","price","single_price","send_num","send_weight","date2Str","ship_date","advance_mode","advance_charge","delay_day","showCustomerDetail","fName","fMonths","detail_data","order","bill_no","veh_ves_name","coll_price","tot_price","inv_no","warehouse","spec","brand_no","contract_no","iCheck","getDateTimePickerOptions","minViewMode","datetimepicker","on","showHtmlElement","selected","chart_data","customerChart","find","each","this","nlApp","setTitle","showPleaseWait","caption","subtract","stat_data","names","hidePleaseWait","s1","s2","vh1","vh2","vh3","vh4","vh5","vh6","vh7","vh8","vh9","vh10","vhc","vs1","vs2","vs3","vs4","vs5","vs6","vs7","vs8","vs9","vs10","vsc","toFixedNumber","vhOwnDeposit","vhOwnProfit","vhFixedCost","vhProfit","vsOwnDeposit","vsOwnProfit","vsFixedCost","vsProfit","profit1","profit","tmp","t1","t2","summary","showDetailDialog","category","mList","initSelect","val","customer","elementEventRegister","tableToExcel","html","selectedMonth","selectedCustomer","nlContextMenu","custDetailMenuItem","display","left","pageX","top","pageY","tr","closest","row","index","getTableCellChildren","hide"],"mappings":"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","file":"report_stat.js","sourcesContent":["/**\r\n * Created by ezefjia on 7/8/2014.\r\n */\r\n\r\n$(function () {\r\n  var titleEN2CN = {\r\n    \"settledWDS\": \"结算吨数(代收)\", \"notSettledWDS\": \"未结算吨数(代收)\", \"notNeedWDS\": \"不需结算吨数(代收)\",\r\n    \"settledWZT\": \"结算吨数(自提)\", \"notSettledWZT\": \"未结算吨数(自提)\", \"notNeedWZT\": \"不需结算吨数(自提)\",\r\n    \"totalWeight\": \"总吨数\", \"totalPrice\": \"总金额\"\r\n  };\r\n\r\n  var tableBody    = $('#table-tbody');\r\n  var startDateGrp = $('#start-date-grp');\r\n  var endDateGrp   = $('#end-date-grp');\r\n  var yearGrp      = $('#year-grp');\r\n  var monthGrp     = $('#month-grp');\r\n  var dbData = [];\r\n  var chartData = [];\r\n  var chart;\r\n  var startDate, endDate;\r\n  var allNames = [];\r\n  var btnOk = $('#stat-btn-ok');\r\n  var ckShowDiagram = $('#show-statistics-report');\r\n  var action = local_action;\r\n  var ldata;\r\n  var chartWeight = true;\r\n\r\n  var detailTBody = $('#detail-tbody');\r\n\r\n  if (action === \"CUSTOMER\") {\r\n    var billNameFilter = new FilterElementD($('#bill-name'), sort_pinyin(local_data), false, true, null);\r\n    ldata = null;\r\n  } else {\r\n    ldata = {};\r\n    local_data.forEach(function(ld) {\r\n      ldata[ld.month] = {drayage: ld.drayage, forklift: ld.forklift}\r\n    });\r\n  }\r\n\r\n  ckShowDiagram.iCheck('uncheck');\r\n  initial();\r\n\r\n  function dateChanged(e) {\r\n    var me = $(e.target);\r\n    var id = me.attr('id');\r\n    if (id === \"month-grp\") {\r\n      startDate = e.date.startOf('month');\r\n      endDate = moment(startDate).add(1, 'months');\r\n      setHtmlElementDisabled(btnOk, false);\r\n    }\r\n    else if (id === \"start-date-grp\") {\r\n      endDateGrp.data(\"DateTimePicker\").setMinDate(e.date);\r\n      startDate = e.date.startOf('month');\r\n      if (startDate && endDate && startDate.isBefore(endDate)) {\r\n        setHtmlElementDisabled(btnOk, false);\r\n      }\r\n    }\r\n    else if (id === \"end-date-grp\") {\r\n      startDateGrp.data(\"DateTimePicker\").setMaxDate(e.date);\r\n      endDate = e.date.startOf('month').add(1, 'months');\r\n      if (startDate && endDate && startDate.isBefore(endDate)) {\r\n        setHtmlElementDisabled(btnOk, false);\r\n      }\r\n    }\r\n    else {\r\n      startDate = e.date.startOf('year');\r\n      endDate = moment(startDate).add(1, 'years');\r\n      setHtmlElementDisabled(btnOk, false);\r\n    }\r\n  }\r\n\r\n  function getMonthList() {\r\n    var numOfMonth = endDate.diff(startDate, 'months');\r\n    var monthList = [];\r\n    var date = moment(startDate);\r\n    for (var i = 0; i < numOfMonth; ++i) {\r\n      monthList.push(date.format('YYYY-MM'));\r\n      date.add(1, 'months');\r\n    }\r\n\r\n    return monthList;\r\n  }\r\n\r\n  function generateCustomerData() {\r\n    var obj = { fName: billNameFilter.selected, fDate1: startDate.toISOString(), fDate2: endDate.toISOString(), fMonths: getMonthList() };\r\n    $.get('/get_statistics_data', obj, function (data) {\r\n      var result = jQuery.parseJSON(data);\r\n\r\n      dbData    = [];\r\n      allNames  = [];\r\n      if (result.ok) {\r\n        dbData = result.stat_data;\r\n        allNames = result.names;\r\n        showCustomerData(false);\r\n      }\r\n\r\n      ckShowDiagram.iCheck('uncheck');\r\n      nlApp.hidePleaseWait();\r\n    });\r\n  }\r\n\r\n  function generateVesselData() {\r\n    var obj = { fDate1: startDate.toISOString(), fDate2: endDate.toISOString(), fMonths: getMonthList() }; // , fVehicles: vehicles };\r\n    $.get('/get_vessel_revenue_data', obj, function (data) {\r\n      dbData = [];\r\n      var result = jQuery.parseJSON(data);\r\n      if (result.ok) {\r\n        dbData = result.stat_data;\r\n      }\r\n\r\n      tableBody.empty();\r\n      var s1 = '<tr><td rowspan=\"2\" style=\"text-align:center;vertical-align:middle\">{0}</td><td>{1}</td><td>{2}</td><td>{3}</td><td>{4}</td><td>{5}</td><td>{6}</td><td>{7}</td><td>{8}</td><td>{9}</td><td>{10}</td><td>{11}</td><td>{12}</td><td>{13}</td><td>{14}</td><td style=\"font-weight:bold;color:{15}\">{16}</td></tr>';\r\n      var s2 = '<tr><td>{0}</td><td>{1}</td><td>{2}</td><td>{3}</td><td>{4}</td><td>{5}</td><td>{6}</td><td>{7}</td><td>{8}</td><td>{9}</td><td>{10}</td><td>{11}</td><td>{12}</td><td>{13}</td><td style=\"font-weight:bold;color:{14}\">{15}</td></tr>';\r\n      var vh1 = 0, vh2 = 0, vh3 = 0, vh4 = 0, vh5 = 0, vh6 = 0, vh7 = 0, vh8 = 0, vh9 = 0, vh10 = 0, vhc = 0;\r\n      var vs1 = 0, vs2 = 0, vs3 = 0, vs4 = 0, vs5 = 0, vs6 = 0, vs7 = 0, vs8 = 0, vs9 = 0, vs10 = 0, vsc = 0;\r\n\r\n      var drayage = 0, forklift = 0;\r\n      \r\n      dbData.forEach(function(vv) {\r\n        vv.vhTotal = toFixedNumber(vv.vhTotal, 3);\r\n        vv.vhRevenue = toFixedNumber(vv.vhRevenue, 3);\r\n        vv.vhOwnWeight = toFixedNumber(vv.vhOwnWeight, 3);\r\n        vv.vhOwnIncome = toFixedNumber(vv.vhOwnIncome, 3);\r\n        vv.vhOwnDeposit = toFixedNumber(vv.vhOwnDeposit, 3);\r\n        vv.vhOwnProfit = toFixedNumber(vv.vhOwnIncome - vv.vhOwnDeposit, 3);\r\n        vv.vhNonOwnWeight = toFixedNumber(vv.vhNonOwnWeight, 3);\r\n        vv.vhNonOwnIncome = toFixedNumber(vv.vhNonOwnIncome, 3);\r\n        vv.vhNonOwnDeposit = toFixedNumber(vv.vhNonOwnDeposit, 3);\r\n        vv.vhFixedCost = toFixedNumber(vv.vhFixedCost, 3);\r\n        vv.vhProfit = toFixedNumber(vv.vhNonOwnIncome - vv.vhNonOwnDeposit, 3);\r\n\r\n        vv.vsTotal = toFixedNumber(vv.vsTotal, 3);\r\n        vv.vsRevenue = toFixedNumber(vv.vsRevenue, 3);\r\n        vv.vsOwnWeight = toFixedNumber(vv.vsOwnWeight, 3);\r\n        vv.vsOwnIncome = toFixedNumber(vv.vsOwnIncome, 3);\r\n        vv.vsOwnDeposit = toFixedNumber(vv.vsOwnDeposit, 3);\r\n        vv.vsOwnProfit = toFixedNumber(vv.vsOwnIncome - vv.vsOwnDeposit, 3);\r\n        vv.vsNonOwnWeight = toFixedNumber(vv.vsNonOwnWeight, 3);\r\n        vv.vsNonOwnIncome = toFixedNumber(vv.vsNonOwnIncome, 3);\r\n        vv.vsNonOwnDeposit = toFixedNumber(vv.vsNonOwnDeposit, 3);\r\n        vv.vsFixedCost = toFixedNumber(vv.vsFixedCost, 3);\r\n        vv.vsProfit = toFixedNumber(vv.vsNonOwnIncome - vv.vsNonOwnDeposit, 3);\r\n\r\n        var profit1 = vv.vsOwnProfit + vv.vsProfit - vv.vsFixedCost;\r\n        var profit  = vv.vhOwnProfit + vv.vhProfit - vv.vhFixedCost;\r\n        tableBody.append(s1.format(vv.month, '船运', vv.vsTotal, vv.vsRevenue, vv.vsOwnWeight, vv.vsOwnIncome, vv.vsOwnDeposit, vv.vsOwnProfit,\r\n          vv.vsNonOwnWeight, vv.vsNonOwnIncome, vv.vsNonOwnDeposit, vv.vsProfit, vv.vsFixedCost, 0, 0, (profit1 >= 0 ? 'red': 'green'), getStrValue(profit1)));\r\n\r\n        var tmp = ldata[vv.month];\r\n        if (tmp) {\r\n          drayage += tmp.drayage;\r\n          forklift += tmp.forklift;\r\n          tableBody.append(s2.format('车运', vv.vhTotal, vv.vhRevenue, vv.vhOwnWeight, vv.vhOwnIncome, vv.vhOwnDeposit, vv.vhOwnProfit,\r\n            vv.vhNonOwnWeight, vv.vhNonOwnIncome, vv.vhNonOwnDeposit, vv.vhProfit, vv.vhFixedCost, getStrValue(tmp.drayage), getStrValue(tmp.forklift), (profit >= 0 ? 'red': 'green'), getStrValue(profit + tmp.drayage + tmp.forklift)));\r\n        } else {\r\n          tableBody.append(s2.format('车运', vv.vhTotal, vv.vhRevenue, vv.vhOwnWeight, vv.vhOwnIncome, vv.vhOwnDeposit, vv.vhOwnProfit,\r\n            vv.vhNonOwnWeight, vv.vhNonOwnIncome, vv.vhNonOwnDeposit, vv.vhProfit, vv.vhFixedCost, 0, 0, (profit >= 0 ? 'red' : 'green'), getStrValue(profit)));\r\n        }\r\n\r\n        vh1 += vv.vhTotal;\r\n        vh2 += vv.vhRevenue;\r\n        vh3 += vv.vhOwnWeight;\r\n        vh4 += vv.vhOwnIncome;\r\n        vh5 += vv.vhOwnDeposit;\r\n        vh6 += vv.vhOwnProfit;\r\n        vh7 += vv.vhNonOwnWeight;\r\n        vh8 += vv.vhNonOwnIncome;\r\n        vh9 += vv.vhNonOwnDeposit;\r\n        vh10 += vv.vhProfit;\r\n        vhc += vv.vhFixedCost;\r\n\r\n        vs1 += vv.vsTotal;\r\n        vs2 += vv.vsRevenue;\r\n        vs3 += vv.vsOwnWeight;\r\n        vs4 += vv.vsOwnIncome;\r\n        vs5 += vv.vsOwnDeposit;\r\n        vs6 += vv.vsOwnProfit;\r\n        vs7 += vv.vsNonOwnWeight;\r\n        vs8 += vv.vsNonOwnIncome;\r\n        vs9 += vv.vsNonOwnDeposit;\r\n        vs10 += vv.vsProfit;\r\n        vsc += vv.vsFixedCost;\r\n      });\r\n\r\n      if (dbData.length > 1) {\r\n        var t1 = vh6 + vh10 - vhc + drayage + forklift;\r\n        var t2 = vs6 + vs10 - vsc;\r\n        tableBody.append(s1.format(\"总计\", '船运', getStrValue(vs1), getStrValue(vs2), getStrValue(vs3), getStrValue(vs4),\r\n          getStrValue(vs5), getStrValue(vs6), getStrValue(vs7), getStrValue(vs8), getStrValue(vs9), getStrValue(vs10), getStrValue(vsc), 0, 0, (t2 >= 0 ? 'red': 'green'), getStrValue(t2)));\r\n        tableBody.append(s2.format('车运', getStrValue(vh1), getStrValue(vh2), getStrValue(vh3), getStrValue(vh4),\r\n          getStrValue(vh5), getStrValue(vh6), getStrValue(vh7), getStrValue(vh8), getStrValue(vh9), getStrValue(vh10), getStrValue(vhc), getStrValue(drayage), getStrValue(forklift), (t1 >= 0 ? 'red': 'green'), getStrValue(t1)));\r\n      }\r\n\r\n      ckShowDiagram.iCheck('uncheck');\r\n      nlApp.hidePleaseWait();\r\n    });\r\n  }\r\n\r\n  function showCustomerData(isZeroToSpace) {\r\n    var len = dbData.length;\r\n    if (len > 0) {\r\n      tableBody.empty();\r\n      var s = '<tr><td>{0}</td><td>{1}</td><td style=\"color:blue\">{2}</td><td>{3}</td><td style=\"color:blue\">{4}</td><td>{5}</td><td>{6}</td><td style=\"color:blue\">{7}</td><td>{8}</td><td style=\"color:blue\">{9}</td><td>{10}</td><td>{11}</td><td align=\"right\"><code>{12}</code></td></tr>';\r\n      var wds1 = 0, wds2 = 0, wds3 = 0, wzt1 = 0, wzt2 = 0, wzt3 = 0, total = 0, tprice = 0;\r\n      var pds1 = 0, pds2 = 0, pzt1 = 0, pzt2 = 0;\r\n      var i = 0, item;\r\n\r\n      if (isZeroToSpace) {\r\n        for (i = 0; i < len; ++i) {\r\n          item = dbData[i];\r\n          wds1 += item.settledWDS;\r\n          wds2 += item.notSettledWDS;\r\n          pds1 += item.settledPDS;\r\n          pds2 += item.notSettledPDS;\r\n          wds3 += item.notNeedWDS;\r\n          wzt1 += item.settledWZT;\r\n          wzt2 += item.notSettledWZT;\r\n          pzt1 += item.settledPZT;\r\n          pzt2 += item.notSettledPZT;\r\n          wzt3 += item.notNeedWZT;\r\n          total += item.totalWeight;\r\n          tprice += item.totalPrice;\r\n\r\n          tableBody.append(s.format(item.name,\r\n            item.settledWDS > 0 ? item.settledWDS : '',\r\n            item.settledPDS > 0 ? item.settledPDS : '',\r\n            item.notSettledWDS > 0 ? item.notSettledWDS : '',\r\n            item.notSettledPDS > 0 ? item.notSettledPDS : '',\r\n            item.notNeedWDS > 0 ? item.notNeedWDS : '',\r\n            item.settledWZT > 0 ? item.settledWZT : '',\r\n            item.settledPZT > 0 ? item.settledPZT : '',\r\n            item.notSettledWZT > 0 ? item.notSettledWZT : '',\r\n            item.notSettledPZT > 0 ? item.notSettledPZT : '',\r\n            item.notNeedWZT > 0 ? item.notNeedWZT : '', item.totalWeight, item.totalPrice));\r\n        }\r\n      } else {\r\n        for (i = 0; i < len; ++i) {\r\n          item = dbData[i];\r\n          wds1 += item.settledWDS;\r\n          wds2 += item.notSettledWDS;\r\n          pds1 += item.settledPDS;\r\n          pds2 += item.notSettledPDS;\r\n          wds3 += item.notNeedWDS;\r\n          wzt1 += item.settledWZT;\r\n          wzt2 += item.notSettledWZT;\r\n          pzt1 += item.settledPZT;\r\n          pzt2 += item.notSettledPZT;\r\n          wzt3 += item.notNeedWZT;\r\n          total += item.totalWeight;\r\n          tprice += item.totalPrice;\r\n\r\n          tableBody.append(s.format(item.name,\r\n            item.settledWDS, item.settledPDS, item.notSettledWDS, item.notSettledPDS, item.notNeedWDS,\r\n            item.settledWZT, item.settledPZT, item.notSettledWZT, item.notSettledPZT, item.notNeedWZT, item.totalWeight, item.totalPrice));\r\n        }\r\n      }\r\n\r\n      tableBody.append(s.format(\"总计\", getStrValue(wds1), getStrValue(pds1), getStrValue(wds2), getStrValue(pds2), getStrValue(wds3),\r\n        getStrValue(wzt1), getStrValue(pzt1), getStrValue(wzt2), getStrValue(pzt2), getStrValue(wzt3), getStrValue(total), getStrValue(tprice)));\r\n    }\r\n  }\r\n\r\n  function showCustomerChart() {\r\n    var balloonText = \"<span style='font-size:11px;'>[[title]] :<b>[[value]]</b></span>\";\r\n    var graphs = [];\r\n    var legend = {\r\n      position: \"bottom\",\r\n      valueText: \"[[value]]\",\r\n      valueWidth: 100,\r\n      valueAlign: \"left\",\r\n      equalWidths: false,\r\n      periodValueText: \"[[value.sum]]\"\r\n    };\r\n\r\n    if (chartData.length > 1) {\r\n      allNames.forEach(function(name) {\r\n        graphs.push({\r\n          type: \"line\",\r\n          title: name,\r\n          valueField: name,\r\n          lineAlpha: 0,\r\n          fillAlphas: 0.7,\r\n          balloonText: balloonText\r\n        });\r\n      });\r\n\r\n      chart = AmCharts.makeChart(\"stat-chartdiv\", {\r\n        type: \"serial\",\r\n        dataProvider: chartData,\r\n        marginTop: 10,\r\n        categoryField: \"month\",\r\n\r\n        categoryAxis: {\r\n          gridAlpha: 0.07,\r\n          axisColor: \"#DADADA\",\r\n          minorGridEnabled: true,\r\n\r\n          guides: [{\r\n            lineColor: \"#CC0000\",\r\n            inside: true,\r\n            value: 10,\r\n            toValue: 20,\r\n            fillColor: \"#00CC00\",\r\n            fillAlpha: 0.2\r\n          }]\r\n        },\r\n        valueAxes: [{\r\n          stackType: \"regular\",\r\n          gridAlpha: 0.07,\r\n          title: \"金额\"\r\n        }],\r\n\r\n        graphs: graphs,\r\n        legend: legend,\r\n        chartCursor: { }\r\n      });\r\n    }\r\n    else if (chartData.length === 1) {\r\n      for (var key in titleEN2CN) {\r\n        if (titleEN2CN.hasOwnProperty(key)) {\r\n          if (key === 'totalPrice') {\r\n            graphs.push({\r\n              type: \"line\",\r\n              title: titleEN2CN[key],\r\n              valueField: key,\r\n              lineThickness: 2,\r\n              bullet: \"round\",\r\n              balloonText: balloonText\r\n            });\r\n          } else {\r\n            graphs.push({\r\n              type: \"column\",\r\n              title: titleEN2CN[key],\r\n              valueField: key,\r\n              fillAlphas: 1,\r\n              balloonText: balloonText\r\n            });\r\n          }\r\n        }\r\n      }\r\n\r\n      chart = AmCharts.makeChart(\"stat-chartdiv\", {\r\n        type: \"serial\",\r\n        dataProvider: dbData,\r\n        categoryField: \"name\",\r\n        rotate: true,\r\n\r\n        valueAxes: [{\r\n          position: \"top\",\r\n          title: \"吨数/价格 \" + startDate.format(\"YYYY-MM\"),\r\n          minorGridEnabled: true\r\n        }],\r\n        graphs: graphs,\r\n        legend: legend,\r\n        categoryAxis: { gridPosition: \"start\" },\r\n        creditsPosition:\"top-right\"\r\n      });\r\n    }\r\n  }\r\n\r\n  function customerChart() {\r\n    if (chartData.length === 0 && allNames.length) {\r\n      $('body').css({'cursor': 'wait'});\r\n      var obj = { fName: billNameFilter.selected, fDate1: startDate.toISOString(), fDate2: endDate.toISOString(), fMonths: getMonthList() };\r\n      $.get('/get_customer_chart_data', obj, function (data) {\r\n        var result = jQuery.parseJSON(data);\r\n        if (result.ok) {\r\n          chartData = result.chart_data;\r\n          showCustomerChart();\r\n        }\r\n\r\n        $('body').css({'cursor': 'default'});\r\n      });\r\n    }\r\n    else {\r\n      showCustomerChart();\r\n    }\r\n  }\r\n\r\n  function vesselChart() {\r\n    if (chart) {\r\n      chart.clear();\r\n    }\r\n\r\n    chartData = [];\r\n\r\n    if (chartWeight) {\r\n      dbData.forEach(function(vv) {\r\n        chartData.push({\r\n          month: vv.month,\r\n          '车总吨位': vv.vhTotal,\r\n          '自有车吨位': vv.vhOwnWeight,\r\n          '外挂车吨位': vv.vhNonOwnWeight,\r\n          '船总吨位': vv.vsTotal,\r\n          '自有船吨位': vv.vsOwnWeight,\r\n          '外挂船吨位': vv.vsNonOwnWeight\r\n        });\r\n      });\r\n      allNames = ['车总吨位', '自有车吨位', '外挂车吨位', '船总吨位', '自有船吨位', '外挂船吨位'];\r\n    } else {\r\n      dbData.forEach(function(vv) {\r\n        chartData.push({\r\n          month: vv.month,\r\n          '车总金额': vv.vhRevenue,\r\n          '自有车收金额': vv.vhOwnIncome,\r\n          '外挂车收金额': vv.vhNonOwnIncome,\r\n          '外挂车付金额': vv.vhNonOwnDeposit,\r\n          '船总金额': vv.vsRevenue,\r\n          '自有船收金额': vv.vsOwnIncome,\r\n          '外挂船收金额': vv.vsNonOwnIncome,\r\n          '外挂船付金额': vv.vsNonOwnDeposit\r\n        });\r\n      });\r\n      allNames = ['车总金额', '自有车收金额', '外挂车收金额', '外挂车付金额', '船总金额', '自有船收金额', '外挂船收金额', '外挂船付金额'];\r\n    }\r\n\r\n    var balloonText = \"<span style='font-size:11px;'>[[title]] :<b>[[value]]</b></span>\";\r\n    var legend = {\r\n      position: \"bottom\",\r\n      valueText: \"[[value]]\",\r\n      valueWidth: 100,\r\n      valueAlign: \"left\",\r\n      equalWidths: false,\r\n      periodValueText: \"[[value.sum]]\"\r\n    };\r\n\r\n    chart = new AmCharts.AmSerialChart();\r\n    chart.dataProvider = chartData;\r\n    chart.categoryField = 'month';\r\n\r\n    var categoryAxis = chart.categoryAxis;\r\n//    categoryAxis.labelRotation = 45; // this line makes category values to be rotated\r\n    categoryAxis.gridAlpha = 0;\r\n    categoryAxis.fillAlpha = 1;\r\n    categoryAxis.fillColor = \"#FAFAFA\";\r\n    categoryAxis.gridPosition = \"start\";\r\n\r\n    // value\r\n    var valueAxis = new AmCharts.ValueAxis();\r\n    valueAxis.dashLength = 5;\r\n    valueAxis.title = \"重量\";\r\n    valueAxis.axisAlpha = 0;\r\n    chart.addValueAxis(valueAxis);\r\n\r\n    allNames.forEach(function(name) {\r\n      var graph = new AmCharts.AmGraph();\r\n      graph.title = name;\r\n      graph.valueField = name;\r\n//      graph.colorField = \"color\";\r\n      graph.balloonText = balloonText;\r\n      graph.type = \"column\";\r\n      graph.lineAlpha = 0;\r\n      graph.fillAlphas = 1;\r\n      chart.addGraph(graph);\r\n    });\r\n\r\n    // CURSOR\r\n    var chartCursor = new AmCharts.ChartCursor();\r\n    chartCursor.cursorAlpha = 0;\r\n    chartCursor.zoomable = false;\r\n    chartCursor.categoryBalloonEnabled = false;\r\n    chart.addChartCursor(chartCursor);\r\n\r\n    chart.creditsPosition = \"top-right\";\r\n    chart.legend = legend;\r\n\r\n    // WRITE\r\n    chart.write(\"stat-chartdiv\");\r\n  }\r\n\r\n  ckShowDiagram.on('ifUnchecked', function() {\r\n    showHtmlElement($('#stat-chartdiv'), false);\r\n    showHtmlElement($('#stat-table'), true);\r\n    showHtmlElement($('#chart-option'), false);\r\n  });\r\n\r\n  ckShowDiagram.on('ifChecked', function() {\r\n    showHtmlElement($('#stat-chartdiv'), true);\r\n    showHtmlElement($('#stat-table'), false);\r\n    showHtmlElement($('#chart-option'), true);\r\n\r\n    if (chart) {\r\n      chart.clear();\r\n    }\r\n\r\n    if (action === \"VESSEL\") {\r\n      vesselChart();\r\n    } else {\r\n      customerChart();\r\n    }\r\n  });\r\n\r\n  $('#statistics-condition').on('click', function() {\r\n    ckShowDiagram.iCheck('uncheck');\r\n    startDate = null;\r\n    endDate = null;\r\n    $('.input-group.date').find('input').each(function() {\r\n      this.value = '';\r\n    });\r\n\r\n    setHtmlElementDisabled(btnOk, true);\r\n    $('#radio_month').iCheck('check');\r\n    $('#stat-condition-dialog').modal({ backdrop: 'static', keyboard: false}).modal('show');\r\n  });\r\n\r\n  btnOk.on('click', function() {\r\n    $('#stat-condition-dialog').modal('hide');\r\n    nlApp.setTitle('数据分析, 请稍等...');\r\n    nlApp.showPleaseWait();\r\n\r\n    if (action === \"CUSTOMER\") {\r\n      var caption = $('#table-caption');\r\n      caption.text(startDate.format(\"YYYY-MM\") + \" 到 \" + moment(endDate).subtract(1, \"months\").format(\"YYYY-MM\") + \" 月份数据\");\r\n      showHtmlElement(caption, true);\r\n\r\n      generateCustomerData();\r\n    }\r\n    else if (action === \"VESSEL\") {\r\n      generateVesselData();\r\n    }\r\n  });\r\n\r\n  function showVesselDetail(isSummary, vehType, month) {\r\n    $('body').css({'cursor':'wait'});\r\n    var s = moment(month).startOf('month');\r\n    var e = moment(s).add(1, 'months');\r\n    var obj = { fDate1: s.toISOString(), fDate2: e.toISOString(), fVehType: vehType };\r\n\r\n    if (isSummary) {\r\n      $('#summary-dialog-title').text((vehType === '外挂' ? '车船外挂统计:' + month : '车船自有统计:' + month));\r\n      obj.fSummary = 'YES';\r\n      $.get('/get_vessel_alloc_detail', obj, function (data) {\r\n        var result = jQuery.parseJSON(data);\r\n        if (result.ok) {\r\n          var one = result.summary_data;\r\n          var fmt = '<tr><td>{0}</td><td>{1}</td><td>{2}</td><td>{3}</td></tr>';\r\n\r\n          detailTBody.empty();\r\n          for (var key in one) {\r\n            if (one.hasOwnProperty(key)) {\r\n              detailTBody.append(fmt.format(key, getStrValue(one[key].weight), getStrValue(one[key].amount), one[key].contact));\r\n            }\r\n          }\r\n\r\n          $('#stat-detail-dialog').modal({backdrop: 'static', keyboard: false}).modal('show');\r\n        } else {\r\n          bootbox.alert('查询数据出错');\r\n        }\r\n\r\n        $('body').css({'cursor':'default'});\r\n      });\r\n    }\r\n    else {\r\n      $('#detail-title').text((vehType === '外挂' ? '车船外挂明细:' + month : '车船自有明细:' + month));\r\n      obj.fSummary = 'NO';\r\n      $.get('/get_vessel_alloc_detail', obj, function (data) {\r\n        var result = jQuery.parseJSON(data);\r\n        if (result.ok) {\r\n          var vObj = result.vessel_detail;\r\n          var nameList = result.vehNameList;\r\n\r\n          var trStr = '<tr><td>{0}</td><td>{1}</td><td>{2}</td><td>{3}</td><td>{4}</td><td>{5}</td><td>{6}</td><td>{7}</td><td>{8}</td><td>{9}</td><td>{10}</td></tr>';\r\n          vesselDetailBody.empty();\r\n          nameList.forEach(function(name) {\r\n            if (vObj.hasOwnProperty(name)) {\r\n              vObj[name].forEach(function (t) {\r\n                vesselDetailBody.append(trStr.format(name, t.name, t.ship_from, t.ship_to, getStrValue(t.price), getStrValue(t.single_price), t.send_num,\r\n                  getStrValue(t.send_weight), date2Str(t.ship_date), t.advance_mode + ':' + getStrValue(t.advance_charge), t.delay_day));\r\n              })\r\n            }\r\n          });\r\n\r\n          $('#vessel-detail-dialog').modal({ backdrop: 'static', keyboard: false}).modal('show');\r\n        } else {\r\n          bootbox.alert('不能获取明细数据');\r\n        }\r\n\r\n        $('body').css({'cursor':'default'});\r\n      });\r\n    }\r\n  }\r\n\r\n  function showCustomerDetail(nameList) {\r\n    if (startDate && endDate) {\r\n      $('body').css({'cursor': 'wait'});\r\n\r\n      detailTBody.empty();\r\n      var obj = {\r\n        fName: nameList,\r\n        fDate1: startDate.toISOString(),\r\n        fDate2: endDate.toISOString(),\r\n        fMonths: getMonthList()\r\n      };\r\n      $.get('/get_customer_detail', obj, function (data) {\r\n        var result = jQuery.parseJSON(data);\r\n        if (result.ok) {\r\n          var trHtml = '<tr><td>{0}</td><td>{1}</td><td>{2}</td><td>{3}</td><td>{4}</td><td>{5}</td><td>{6}</td><td>{7}</td><td>{8}</td><td>{9}</td><td>{10}</td><td>{11}</td><td>{12}</td><td>{13}</td><td>{14}</td><td>{15}</td></tr>';\r\n          result.detail_data.forEach(function (item) {\r\n            detailTBody.append(trHtml.format(item.order, item.bill_no, item.name, item.veh_ves_name, item.ship_to,\r\n              item.coll_price, item.price, item.tot_price, item.send_num, item.send_weight,\r\n              date2Str(item.ship_date), item.inv_no, item.warehouse, item.spec, item.brand_no, item.contract_no));\r\n          });\r\n\r\n          $('#price-detail-dialog').modal({backdrop: 'static', keyboard: false}).modal('show');\r\n        } else {\r\n          bootbox.alert('获取明细出错');\r\n        }\r\n\r\n        $('body').css({'cursor': 'default'});\r\n      });\r\n    }\r\n  }\r\n\r\n  if (action === \"VESSEL\") {\r\n    var vesselDetailBody = $('#vessel-detail-tbodys');\r\n    var summary = false;\r\n    var vehType;\r\n\r\n    function showDetailDialog(isSummary, category) {\r\n      if (dbData.length === 0) {\r\n        bootbox.alert(\"还没有数据,请设置查询日期\");\r\n      } else {\r\n        summary = isSummary;\r\n        vehType = category;\r\n        if (dbData.length > 1) {\r\n          var mList = [];\r\n          dbData.forEach(function (item) {\r\n            mList.push(item.month);\r\n          });\r\n\r\n          initSelect($('#detail-month'), mList, false);\r\n          $('#choose-month-dialog').modal({ backdrop: 'static', keyboard: false}).modal('show');\r\n        } else {\r\n          showVesselDetail(summary, category, dbData[0].month);\r\n        }\r\n      }\r\n    }\r\n\r\n    // button function handle\r\n    $('#deposit-detail').on('click', function () { showDetailDialog(true, '外挂'); });\r\n    $('#vessel-deposit-detail').on('click', function () { showDetailDialog(false, '外挂'); });\r\n    $('#own-detail').on('click', function () { showDetailDialog(true, '自有'); });\r\n    $('#vessel-own-detail').on('click', function () { showDetailDialog(false, '自有'); });\r\n\r\n    // after select month, and show data if click OK\r\n    $('#choose-month-ok').on('click', function () {\r\n      var month = $('#detail-month').val();\r\n      if (month) {\r\n        showVesselDetail(summary, vehType, month);\r\n      }\r\n    });\r\n  }\r\n  else {  // CUSTOMER\r\n    $('#price-detail').on('click', function () {\r\n      showCustomerDetail(billNameFilter.selected);\r\n    });\r\n\r\n    $('#single-customer-detail').on('click', function() {\r\n      if (dbData.length === 0) {\r\n        bootbox.alert(\"还没有数据,请设置查询日期\");\r\n      } else {\r\n        if (dbData.length > 1) {\r\n          initSelect($('#customer-list'), allNames, false);\r\n          $('#choose-customer-dialog').modal({ backdrop: 'static', keyboard: false}).modal('show');\r\n        } else {\r\n          showCustomerDetail([dbData[0].name]);\r\n        }\r\n      }\r\n    });\r\n\r\n    $('#choose-customer-ok').on('click', function () {\r\n      var customer = $('#customer-list').val();\r\n      if (customer) {\r\n        showCustomerDetail([customer]);\r\n      }\r\n    });\r\n  }\r\n\r\n  elementEventRegister($('#export-detail'), 'click', function() {  tableToExcel($('#detail-table').html(), \"data\"); });\r\n  elementEventRegister($('#export-vessel-detail'), 'click', function() {  tableToExcel($('#vessel-detail-table').html(), \"data\"); });\r\n\r\n  $('#radio_month').on('ifChecked', function() {\r\n    showHtmlElement($('#year-choose'), false);\r\n    showHtmlElement($('#non-year-choose'), true);\r\n    showHtmlElement($('#month-choose'), false);\r\n  });\r\n\r\n  $('#radio_single_year').on('ifChecked', function() {\r\n    showHtmlElement($('#year-choose'), true);\r\n    showHtmlElement($('#non-year-choose'), false);\r\n    showHtmlElement($('#month-choose'), false);\r\n  });\r\n\r\n  $('#radio_single_month').on('ifChecked', function() {\r\n    showHtmlElement($('#month-choose'), true);\r\n    showHtmlElement($('#year-choose'), false);\r\n    showHtmlElement($('#non-year-choose'), false);\r\n  });\r\n\r\n  $('#chart-weight').on('ifChecked', function() {\r\n    chartWeight = true;\r\n    vesselChart();\r\n  });\r\n\r\n  $('#chart-amount').on('ifChecked', function() {\r\n    chartWeight = false;\r\n    vesselChart();\r\n  });\r\n\r\n  $('#show-zero-space').on('ifChecked', function() { showCustomerData(true); });\r\n  $('#show-zero-space').on('ifUnchecked', function() { showCustomerData(false); });\r\n\r\n  elementEventRegister($('#search-export'), 'click', function() {  tableToExcel($('#stat-table').html(), \"data\"); });\r\n\r\n  function initial() {\r\n    var opts = getDateTimePickerOptions();\r\n\r\n    opts.minViewMode = 'months';\r\n    opts.format = 'YYYY-MM';\r\n    startDateGrp.datetimepicker(opts).on('dp.change', dateChanged);\r\n    endDateGrp.datetimepicker(opts).on('dp.change', dateChanged);\r\n    monthGrp.datetimepicker(opts).on('dp.change', dateChanged);\r\n\r\n    opts.minViewMode = 'years';\r\n    opts.format = 'YYYY';\r\n    yearGrp.datetimepicker(opts).on('dp.change', dateChanged);\r\n  }\r\n\r\n\r\n  // Popup menu when right mouse click.\r\n  var nlContextMenu = $(\"#nlContextMenu\");\r\n  var custDetailMenuItem = $('#show-customer-detail');\r\n  var selectedMonth,\r\n      selectedCustomer;\r\n\r\n  $(\"body\").on(\"contextmenu\", \"table tbody tr\", function(e) {\r\n    nlContextMenu.css({\r\n      display: \"block\",\r\n      left: e.pageX,\r\n      top: e.pageY\r\n    });\r\n\r\n    var tr = $(this).closest('tr');\r\n    var row = tr.index();\r\n    if (action === 'CUSTOMER') {\r\n      selectedCustomer = getTableCellChildren(tr, 0).text();\r\n      custDetailMenuItem.text('显示' + selectedCustomer + '明细');\r\n    } else {\r\n      selectedMonth = moment(startDate).add(row / 2, 'months').format('YYYY-MM');\r\n    }\r\n\r\n    return false;\r\n  });\r\n\r\n  nlContextMenu.on(\"click\", function() { nlContextMenu.hide(); });\r\n  $(\"section\").on('click', function() { nlContextMenu.hide(); });\r\n\r\n  custDetailMenuItem.on('click', function() {\r\n    if (selectedCustomer) showCustomerDetail([selectedCustomer]);\r\n\r\n    return false;\r\n  });\r\n\r\n  $('#show-own-summary').on('click', function() {\r\n    if (selectedMonth) {\r\n      showVesselDetail(true, '自有', selectedMonth);\r\n    }\r\n\r\n    return false;\r\n  });\r\n  $('#show-own-detail').on('click', function() {\r\n    if (selectedMonth) {\r\n      showVesselDetail(false, '自有', selectedMonth);\r\n    }\r\n\r\n    return false;\r\n  });\r\n\r\n  $('#show-deposit-summary').on('click', function() {\r\n    if (selectedMonth) {\r\n      showVesselDetail(true, '外挂', selectedMonth);\r\n    }\r\n\r\n    return false;\r\n  });\r\n  $('#show-deposit-detail').on('click', function() {\r\n    if (selectedMonth) {\r\n      showVesselDetail(false, '外挂', selectedMonth);\r\n    }\r\n\r\n    return false;\r\n  });\r\n});\r\n"]}